let users = {
  sarahedo: {
    id: 'sarahedo',
    password:'password123',
    name: 'Sarah Edo',
    avatarURL: `data:image/jpeg;base64,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`,
    answers: {
      "8xf0y6ziyjabvozdd253nd": 'optionOne',
      "6ni6ok3ym7mf1p33lnez": 'optionOne',
      "am8ehyc8byjqgar0jgpub9": 'optionTwo',
      "loxhs1bqm25b708cmbf3g": 'optionTwo'
    },
    questions: ['8xf0y6ziyjabvozdd253nd', 'am8ehyc8byjqgar0jgpub9']
  },
  tylermcginnis: {
    id: 'tylermcginnis',
    password:'abc321',
    name: 'Tyler McGinnis',
    avatarURL: `https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTTH4dlV0UI27TlS52PbJ2N78hINGV4m43mKg&s`,
    answers: {
      "vthrdm985a262al8qx3do": 'optionOne',
      "xj352vofupe1dqz9emx13r": 'optionTwo',
    },
    questions: ['loxhs1bqm25b708cmbf3g', 'vthrdm985a262al8qx3do'],
  },
  mtsamis: {
    id: 'mtsamis',
    password:'xyz123',
    name: 'Mike Tsamis',
    avatarURL: `https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSrS_HIXt1Uv6NGsgTQhX3KIdpiex9VjjWwGw&s`,
    answers: {
      "xj352vofupe1dqz9emx13r": 'optionOne',
      "vthrdm985a262al8qx3do": 'optionTwo',
      "6ni6ok3ym7mf1p33lnez": 'optionOne'
    },
    questions: ['6ni6ok3ym7mf1p33lnez', 'xj352vofupe1dqz9emx13r'],
  },
  zoshikanlu: {
    id: 'zoshikanlu',
    password:'pass246',
    name: 'Zenobia Oshikanlu',
    avatarURL: `https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ2F1rFKPOBLAMv5Z53N8j8XlKS7gH8Awb2Eg&s`,
    answers: {
      "xj352vofupe1dqz9emx13r": 'optionOne',
    },
    questions: [],
  }
}

let questions = {
  "8xf0y6ziyjabvozdd253nd": {
    id: '8xf0y6ziyjabvozdd253nd',
    author: 'sarahedo',
    timestamp: 1467166872634,
    optionOne: {
      votes: ['sarahedo'],
      text: 'Build our new application with Javascript',
    },
    optionTwo: {
      votes: [],
      text: 'Build our new application with Typescript'
    }
  },
  "6ni6ok3ym7mf1p33lnez": {
    id: '6ni6ok3ym7mf1p33lnez',
    author: 'mtsamis',
    timestamp: 1468479767190,
    optionOne: {
      votes: [],
      text: 'hire more frontend developers',
    },
    optionTwo: {
      votes: ['mtsamis', 'sarahedo'],
      text: 'hire more backend developers'
    }
  },
  "am8ehyc8byjqgar0jgpub9": {
    id: 'am8ehyc8byjqgar0jgpub9',
    author: 'sarahedo',
    timestamp: 1488579767190,
    optionOne: {
      votes: [],
      text: 'conduct a release retrospective 1 week after a release',
    },
    optionTwo: {
      votes: ['sarahedo'],
      text: 'conduct release retrospectives quarterly'
    }
  },
  "loxhs1bqm25b708cmbf3g": {
    id: 'loxhs1bqm25b708cmbf3g',
    author: 'tylermcginnis',
    timestamp: 1482579767190,
    optionOne: {
      votes: [],
      text: 'have code reviews conducted by peers',
    },
    optionTwo: {
      votes: ['sarahedo'],
      text: 'have code reviews conducted by managers'
    }
  },
  "vthrdm985a262al8qx3do": {
    id: 'vthrdm985a262al8qx3do',
    author: 'tylermcginnis',
    timestamp: 1489579767190,
    optionOne: {
      votes: ['tylermcginnis'],
      text: 'take a course on ReactJS',
    },
    optionTwo: {
      votes: ['mtsamis'],
      text: 'take a course on unit testing with Jest'
    }
  },
  "xj352vofupe1dqz9emx13r": {
    id: 'xj352vofupe1dqz9emx13r',
    author: 'mtsamis',
    timestamp: 1493579767190,
    optionOne: {
      votes: ['mtsamis', 'zoshikanlu'],
      text: 'deploy to production once every two weeks',
    },
    optionTwo: {
      votes: ['tylermcginnis'],
      text: 'deploy to production once every month'
    }
  },
}

function generateUID () {
  return Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15)
}

export function _getUsers () {
  return new Promise((resolve) => {
    setTimeout(() => resolve({...users}), 1000)
  })
}

export function _getQuestions () {
  return new Promise((resolve) => {
    setTimeout(() => resolve({...questions}), 1000)
  })
}

function formatQuestion ({ optionOneText, optionTwoText, author }) {
  return {
    id: generateUID(),
    timestamp: Date.now(),
    author,
    optionOne: {
      votes: [],
      text: optionOneText,
    },
    optionTwo: {
      votes: [],
      text: optionTwoText,
    }
  }
}

export function _saveQuestion (question) {
  return new Promise((resolve, reject) => {
    if (!question.optionOneText || !question.optionTwoText || !question.author) {
      reject("Please provide optionOneText, optionTwoText, and author");
    }

    const formattedQuestion = formatQuestion(question)
    setTimeout(() => {
      questions = {
        ...questions,
        [formattedQuestion.id]: formattedQuestion
      }

      resolve(formattedQuestion)
    }, 1000)
  })
}

export function _saveQuestionAnswer ({ authedUser, qid, answer }) {
  return new Promise((resolve, reject) => {
    if (!authedUser || !qid || !answer) {
      reject("Please provide authedUser, qid, and answer");
    }

    setTimeout(() => {
      users = {
        ...users,
        [authedUser]: {
          ...users[authedUser],
          answers: {
            ...users[authedUser].answers,
            [qid]: answer
          }
        }
      }

      questions = {
        ...questions,
        [qid]: {
          ...questions[qid],
          [answer]: {
            ...questions[qid][answer],
            votes: questions[qid][answer].votes.concat([authedUser])
          }
        }
      }

      resolve(true)
    }, 500)
  })
}
